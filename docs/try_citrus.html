<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Briana Mittleman" />

<meta name="date" content="2017-02-27" />

<title>Try citrus vingette</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Cell cycle</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jdblischak/workflowr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Try citrus vingette</h1>
<h4 class="author"><em>Briana Mittleman</em></h4>
<h4 class="date"><em>2017-02-27</em></h4>

</div>


<p><strong>Last updated:</strong> 2017-02-27</p>
<p><strong>Code version:</strong> e1c038a</p>
<div id="install-package" class="section level3">
<h3>Install package</h3>
<pre class="r"><code>#install.packages(&quot;devtools&quot;)
#devtools::install_github(&quot;ChenMengjie/Citrus&quot;)
library(&quot;Citrus&quot;)</code></pre>
<div id="install-and-load-packages-for-figures" class="section level4">
<h4>Install and load packages for figures</h4>
<pre class="r"><code>library(reshape2)
library(ggplot2) 
#devtools::install_github(&quot;kassambara/easyGgplot2&quot;)
library(easyGgplot2)
library(stringr)</code></pre>
</div>
</div>
<div id="load-data" class="section level3">
<h3>Load data</h3>
<p>This uses the data from the Beuttner et al cell cycle paper. This dataset has the top 500 non cell cycle genes, 100 cell cycle genes and 20 spikeins with the largest variance accross samples. The data The data has 182 cell opservations for each of the genes in the set.</p>
<pre class="r"><code>data(CellCycleData) 
table(CellCycleData$Label)</code></pre>
<pre><code>
   CellCycle NonCellCycle      Spikein 
         100          500           20 </code></pre>
</div>
<div id="remove-technical-effect" class="section level3">
<h3>Remove technical effect</h3>
<p>The control matrix is cell by gene table with expression for the genes with the spike in label. There are 20 genes and 182 cells.</p>
<p>The target matrix is cell by gene with expression data for the genes that do not have the Spikein label. There are 600 genes and 182 cells.</p>
<pre class="r"><code>Control &lt;- CellCycleData$Expression[, CellCycleData$Label ==
    &quot;Spikein&quot;]
Target &lt;- CellCycleData$Expression[, CellCycleData$Label != &quot;Spikein&quot;]
#run scPLS
#technical factors (k1=2)
#biological factors (k2=5)
system.time(res &lt;- scPLS(Target, Control, k1 = 2, k2 = 5, iter = 100,method = &quot;EM&quot;, Chunk = FALSE, center = TRUE))</code></pre>
<pre><code>   user  system elapsed 
 12.053   0.000  12.031 </code></pre>
<p>The technical effect can be looked at using the spike ins as the control genes and all other genes as the target.</p>
<p>The default algorithm is the “EM-in-Chunks” algorithm, which will randomly devide genes into different chunks, average the estimates from chunks and thus accelarate the computation. The default chunk size is 1000. We recommend to use the “EM-in-Chunks” algorithm only for large gene sets. When Chunk = FALSE, the “Naive EM” algorithm will be used. In addition, scPLS() will center the expression of each gene to mean of 0 unless setting center = FALSE.</p>
<pre class="r"><code>summary(res)</code></pre>
<pre><code>                Length Class      Mode     
Factor            3000 -none-     numeric  
Loading            910 -none-     numeric  
Likelihood           1 -none-     numeric  
Z                  364 -none-     numeric  
lambdaY           1200 -none-     numeric  
lambdaX             40 -none-     numeric  
psi_y              600 -none-     numeric  
Method               1 -none-     character
Adjusted        109200 -none-     numeric  
VarianceSummary      6 data.frame list     </code></pre>
<ul>
<li><p>Confounding factor: lambdaY</p></li>
<li><p>counfounding loaing matrix: z</p></li>
<li><p>strcture factor matrix <span class="math inline">\(\Lambda_\mu\)</span> : Factor</p></li>
<li><p>structured factor loading matrix U: Loading</p></li>
</ul>
<p>The likelihood for 2 is saved as Likelihood, which can be used for model comparison later. The expression matrix after adjusting for coufounding effect is stored in Adjusted, which is calculated by Y − ΛyZ.</p>
<pre class="r"><code>head(res$VarianceSummary)</code></pre>
<pre><code>                   Sample SampleConfounding SampleStructure Model
ENSMUSG00000000127  1.043             0.002           0.088 1.036
ENSMUSG00000000149  1.128             0.017           0.109 1.120
ENSMUSG00000000276  1.188             0.009           0.061 1.181
ENSMUSG00000000308  1.122             0.084           0.074 1.114
ENSMUSG00000000325  1.187             0.004           0.187 1.178
ENSMUSG00000000409  1.142             0.004           0.048 1.135
                   ModelConfounding ModelStructure
ENSMUSG00000000127            0.002          0.089
ENSMUSG00000000149            0.018          0.112
ENSMUSG00000000276            0.009          0.068
ENSMUSG00000000308            0.090          0.076
ENSMUSG00000000325            0.004          0.188
ENSMUSG00000000409            0.004          0.050</code></pre>
<p>VarianceSummary stores total sample variance and sample technical variance as well as total vari- ance and technical variance estimated by the fitted model for each gene. We can further quantify the proportion of variance explained by different sources as the following. For each gene, the expression variance is partitioned into three components: a component that is explained by technical factors, a component that is explained by structured biological factors, and the residual error variance. Genes are evenly divided into ten quantiles based on the sample variance.</p>
<pre class="r"><code>Var &lt;- res$VarianceSummary
ConProp &lt;- round(Var[&quot;ModelConfounding&quot;]/Var[&quot;Model&quot;], 3)
StructuredProp &lt;- round(Var[&quot;ModelStructure&quot;]/Var[&quot;Model&quot;], 3) 
PropTable &lt;- data.frame(ConProp, StructuredProp, 1 - ConProp -
StructuredProp)
colnames(PropTable) &lt;- c(&quot;Tech&quot;, &quot;Structured&quot;, &quot;Residue&quot;)
QuantileTable &lt;- QuantileSummary(PropTable, quantiles = seq(0.1,
1, by = 0.1), rankingby = unlist(Var[&quot;Sample&quot;]))
head(QuantileTable)</code></pre>
<pre><code>        Tech Structured   Residue Quantile
1 0.03171667  0.1387167 0.8295667       10
2 0.03467273  0.1205455 0.8447818       20
3 0.02848333  0.1070500 0.8644667       30
4 0.02846875  0.1271562 0.8443750       40
5 0.03535000  0.1140500 0.8506000       50
6 0.02000000  0.1244918 0.8555082       60</code></pre>
</div>
<div id="visualize-results" class="section level3">
<h3>Visualize results</h3>
<pre class="r"><code>df &lt;- reshape2::melt(QuantileTable, id.vars = &quot;Quantile&quot;) 
colnames(df)[3] &lt;- &quot;Proportion&quot;
colnames(df)[2] &lt;- &quot;Variance&quot;

ff &lt;- ggplot2.barplot(data = df, xName = &quot;Quantile&quot;, yName = &quot;Proportion&quot;, groupName = &quot;Variance&quot;, groupColors = c(&quot;#66B2FF&quot;, &quot;#FFB266&quot;,
&quot;#FFAAD4&quot;), position = position_stack(), backgroundColor = &quot;white&quot;, color = &quot;black&quot;, xtitle = &quot;Quantile (%)&quot;, ytitle = &quot;Proportion&quot;, mainTitle = &quot;&quot;, removePanelGrid = TRUE, removePanelBorder = TRUE, axisLine = c(0.5, &quot;solid&quot;, &quot;black&quot;), ylim = c(0, 1.05), legendPosition = &quot;top&quot;, legendTextFont = c(10, &quot;bold&quot;, &quot;black&quot;))

ff</code></pre>
<p><img src="figure/try_citrus.Rmd/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Figure 1: Decomposition of variance into three components. Genes are evenly divided into ten quantiles based on the sample variance.</p>
<p>Sructured is biological effect from <span class="math inline">\(\Lambda_\mu\)</span> and Tech is from <span class="math inline">\(\Lambda_x\)</span> and <span class="math inline">\(\Lambda_y\)</span></p>
<p><strong>Why does the residue hold such a large proportion?</strong><br />
###Remove cell cylce effect</p>
<p>Use same data set, further remove the cell cycle effect by treating the cell cycle genes as controll and non cell cycle genes as target.</p>
<pre class="r"><code>Expression &lt;- res$Adjusted
#dont account for spikeins
Label &lt;- CellCycleData$Label[CellCycleData$Label != &quot;Spikein&quot;]
Control &lt;- Expression[, Label == &quot;CellCycle&quot;]
Target &lt;- Expression[, Label == &quot;NonCellCycle&quot;]
system.time(res2 &lt;- scPLS(Target, Control, k1 = 2, k2 = 5, iter = 100,
    method = &quot;EM&quot;, Chunk = FALSE, center = TRUE))</code></pre>
<pre><code>   user  system elapsed 
 11.355   0.000  11.340 </code></pre>
<p>Similarly quantify proportion of variance explained by the cell cycle process.</p>
<pre class="r"><code>Var &lt;- res2$VarianceSummary
ConProp &lt;- round(Var[&quot;ModelConfounding&quot;]/Var[&quot;Model&quot;], 3) 
StructuredProp &lt;- round(Var[&quot;ModelStructure&quot;]/Var[&quot;Model&quot;], 3) 
PropTable &lt;- data.frame(ConProp, StructuredProp, 1 - ConProp - StructuredProp)
colnames(PropTable) &lt;- c(&quot;CellCycle&quot;, &quot;Structured&quot;, &quot;Residue&quot;)
median(PropTable$CellCycle)</code></pre>
<pre><code>[1] 0.0685</code></pre>
<p>About 7% of the variance is explained by cell cycle processes.</p>
<pre class="r"><code>QuantileTable &lt;- QuantileSummary(PropTable, quantiles = seq(0.1, 1, by = 0.1), rankingby = unlist(Var[&quot;Sample&quot;]))
df &lt;- reshape2::melt(QuantileTable, id.vars = &quot;Quantile&quot;) 
colnames(df)[3] &lt;- &quot;Proportion&quot;
colnames(df)[2] &lt;- &quot;Variance&quot;


ff &lt;- ggplot2.barplot(data = df, xName = &quot;Quantile&quot;, yName = &quot;Proportion&quot;, groupName = &quot;Variance&quot;, groupColors = c(&quot;#66B2FF&quot;, &quot;#FFB266&quot;,
&quot;#FFAAD4&quot;), position = position_stack(), backgroundColor = &quot;white&quot;, color = &quot;black&quot;, xtitle = &quot;Quantile (%)&quot;, ytitle = &quot;Proportion&quot;, mainTitle = &quot;&quot;, removePanelGrid = TRUE, removePanelBorder = TRUE, axisLine = c(0.5, &quot;solid&quot;, &quot;black&quot;), ylim = c(0, 1.05), legendPosition = &quot;top&quot;, legendTextFont = c(10, &quot;bold&quot;, &quot;black&quot;))
ff</code></pre>
<p><img src="figure/try_citrus.Rmd/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Compare the expression of non cell cycle genes in original dataset and after removing beoth technical effect through spikeins and cell cycle effect with cell cycle genes.</p>
<p>The celltypes code from the userguide does not work. I replaced it with string parsing using the stringr package.</p>
<pre class="r"><code>celltypes &lt;- str_split_fixed(row.names(CellCycleData$Expression), pattern= &quot;_&quot;, n=3)[,1]

pcs &lt;- prcomp(CellCycleData$Expression[, CellCycleData$Label ==
&quot;NonCellCycle&quot;], center = TRUE)
PC1 &lt;- pcs$x[, 1]
PC2 &lt;- pcs$x[, 2]
df &lt;- data.frame(PC1, PC2, &quot;raw&quot;, celltypes) 
colnames(df) &lt;- c(&quot;PC1&quot;, &quot;PC2&quot;, &quot;Method&quot;, &quot;Type&quot;)


ff1 &lt;- ggplot2.scatterplot(data = df, xName = &quot;PC1&quot;, yName = &quot;PC2&quot;, groupName = &quot;Type&quot;, size = 5, backgroundColor = &quot;white&quot;, groupColors = c(&quot;#66B2FF&quot;, &quot;#FFB266&quot;, &quot;#FFAAD4&quot;), xtitle = &quot;PC1&quot;, ytitle = &quot;PC2&quot;, mainTitle = &quot;Raw&quot;, removePanelGrid = TRUE, removePanelBorder = TRUE, setShapeByGroupName = TRUE, showLegend = FALSE, mainTitleFont = c(25, &quot;bold&quot;, &quot;black&quot;), xtitleFont = c(10,&quot;bold&quot;, &quot;black&quot;), ytitleFont = c(10, &quot;bold&quot;, &quot;black&quot;), xTickLabelFont = c(10, &quot;bold&quot;, &quot;black&quot;), yTickLabelFont = c(10, &quot;bold&quot;, &quot;black&quot;))

pcs &lt;- prcomp(res2$Adjusted, center = TRUE)
PC1 &lt;- pcs$x[, 1]
PC2 &lt;- pcs$x[, 2]
df &lt;- data.frame(PC1, PC2, &quot;rmcellcyle&quot;, celltypes) 
colnames(df) &lt;- c(&quot;PC1&quot;, &quot;PC2&quot;, &quot;Method&quot;, &quot;Type&quot;)


ff2 &lt;- ggplot2.scatterplot(data = df, xName = &quot;PC1&quot;, yName = &quot;PC2&quot;,
groupName = &quot;Type&quot;, size = 5, backgroundColor = &quot;white&quot;, groupColors = c(&quot;#66B2FF&quot;, &quot;#FFB266&quot;, &quot;#FFAAD4&quot;), xtitle = &quot;PC1&quot;,
ytitle = &quot;PC2&quot;, mainTitle = &quot;Cell cyle effect removed&quot;, removePanelGrid = TRUE, removePanelBorder = TRUE, setShapeByGroupName = TRUE, showLegend = TRUE, mainTitleFont = c(25, &quot;bold&quot;, &quot;black&quot;), xtitleFont = c(10,
&quot;bold&quot;, &quot;black&quot;), ytitleFont = c(10, &quot;bold&quot;, &quot;black&quot;), xTickLabelFont=c(10, &quot;bold&quot;, &quot;black&quot;), yTickLabelFont= c(10, &quot;bold&quot;, &quot;black&quot;), legendTitle= &quot;Cell type&quot;, legendTitleFont= c(10, &quot;bold&quot;, &quot;black&quot;), legendTextFont = c(10, &quot;bold&quot;, &quot;black&quot;) )</code></pre>
<pre class="r"><code>ff1</code></pre>
<p><img src="figure/try_citrus.Rmd/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ff2</code></pre>
<p><img src="figure/try_citrus.Rmd/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="notes-on-other-algoritms" class="section level3">
<h3>Notes on other algoritms</h3>
<p>scPLS() also provides other alternative algorithms to estimate the confounding factors. Users can select different algorithms by specifying the option method. PCA algorithm implements the initializer of our EM algorithm. The latent factors are estimated from a Singular Value Decomposition. Details of the algorithm can be found in []. Other choices all impose sparsity assumptions on the structured biological factor matrix to improve interpretability. These include “EMSparse” algorithm, with penalty on sparsity of the factor matrix pre-specified, “EMSparseTraining” algorithm with penalty on sparsity learned from training samples, “EMparseNfold” algorithm with penalty on sparsity learned from N fold cross-validation, and “IBP” algorithm with the sparse factor matrix modeled by an Indian Buffet Process prior.</p>
<pre class="r"><code>#try 100 gene chunks 
system.time(res_chuncks_100 &lt;- scPLS(Target, Control, k1 = 2, k2 = 5, iter = 100,
    method = &quot;EM&quot;, Chunk = TRUE , chunk.size = 100, center = TRUE))</code></pre>
<pre><code>   user  system elapsed 
  6.842   0.036   6.873 </code></pre>
<pre class="r"><code>#try 300 gene chunk 
system.time(res_chunks_300 &lt;- scPLS(Target, Control, k1 = 2, k2 = 5, iter = 100,
    method = &quot;EM&quot;, Chunk = TRUE, chunk.size = 300, center = TRUE))</code></pre>
<pre><code>   user  system elapsed 
  8.010   0.048   8.051 </code></pre>
<pre class="r"><code>#try 50 gene chunks
system.time(res_chunks_50 &lt;- scPLS(Target, Control, k1 = 2, k2 = 5, iter = 100,
    method = &quot;EM&quot;, Chunk = TRUE, chunk.size = 50, center = TRUE))</code></pre>
<pre><code>   user  system elapsed 
  7.494   0.058   7.547 </code></pre>
<p>Smaller chunks of genes help the algorithm run faster. With a gene set as small as this sample chunks are not needed. Chunk size is set default to 1000 if Chunk=TRUE. The number of genes comes only from the target genes.</p>
</div>

<hr>
<p>
    This site was created with <a href="http://rmarkdown.rstudio.com">R Markdown</a>
</p>
<hr>

<!-- To enable disqus, uncomment the section below and provide your disqus_shortname -->

<!-- disqus
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'rmarkdown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
